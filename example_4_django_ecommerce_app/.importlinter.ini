# Import Linter Configuration for Clean Architecture
#
# This configuration enforces Clean Architecture boundaries automatically.

[importlinter]
root_package = example_4_django_ecommerce_app
include_external_packages = True

# --------------------------------------------------------------------------
# Contract 1: Clean Architecture layers contract
# --------------------------------------------------------------------------
[importlinter:contract:clean-architecture-layers]
name = Clean Architecture Layer Dependencies
type = layers
layers =
    # L4: Frameworks, Drivers, and external APIs
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l4_frameworks_and_drivers
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l4_frameworks_and_drivers
    example_4_django_ecommerce_app.ecommerce_app.core.products.l4_frameworks_and_drivers
    django

    # L3: Interface Adapters - Gateways, Presenters
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l3_interface_adapters
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l3_interface_adapters
    example_4_django_ecommerce_app.ecommerce_app.core.products.l3_interface_adapters

    # L2: Use Cases - Core application logic
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l2_use_cases
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l2_use_cases
    example_4_django_ecommerce_app.ecommerce_app.core.products.l2_use_cases

    # L1: Entities - Core business objects with no outgoing dependencies
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l1_entities
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l1_entities
    example_4_django_ecommerce_app.ecommerce_app.core.products.l1_entities

# --------------------------------------------------------------------------------
# Contract 2: Customers - Gateways isolation
# --------------------------------------------------------------------------------
[importlinter:contract:customers-gateways-isolation]
name = Customer gateways should not depend on presenters
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l3_interface_adapters.gateways
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l3_interface_adapters.presenters

# --------------------------------------------------------------------------------
# Contract 3: Customers - Presenters isolation
# --------------------------------------------------------------------------------
[importlinter:contract:customers-presenters-isolation]
name = Customer presenters should not depend on gateways
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l3_interface_adapters.presenters
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l3_interface_adapters.gateways

# --------------------------------------------------------------------------------
# Contract 4: Orders - Gateways isolation
# --------------------------------------------------------------------------------
[importlinter:contract:orders-gateways-isolation]
name = Order gateways should not depend on presenters
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l3_interface_adapters.gateways
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l3_interface_adapters.presenters

# --------------------------------------------------------------------------------
# Contract 5: Orders - Presenters isolation
# --------------------------------------------------------------------------------
[importlinter:contract:orders-presenters-isolation]
name = Order presenters should not depend on gateways
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l3_interface_adapters.presenters
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l3_interface_adapters.gateways

# --------------------------------------------------------------------------------
# Contract 6: Products - Gateways isolation
# --------------------------------------------------------------------------------
[importlinter:contract:products-gateways-isolation]
name = Product gateways should not depend on presenters
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.products.l3_interface_adapters.gateways
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.products.l3_interface_adapters.presenters

# --------------------------------------------------------------------------------
# Contract 7: Products - Presenters isolation
# --------------------------------------------------------------------------------
[importlinter:contract:products-presenters-isolation]
name = Product presenters should not depend on gateways
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.products.l3_interface_adapters.presenters
forbidden_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.products.l3_interface_adapters.gateways

# ------------------------------------------------------------------------------------
# Contract 8: External Framework Restrictions
# ------------------------------------------------------------------------------------
[importlinter:contract:no-external-frameworks-in-core]
name = Prevent external frameworks/libraries in core business logic (L1/L2)
type = forbidden
source_modules =
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l1_entities
    example_4_django_ecommerce_app.ecommerce_app.core.customers.l2_use_cases
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l1_entities
    example_4_django_ecommerce_app.ecommerce_app.core.orders.l2_use_cases
    example_4_django_ecommerce_app.ecommerce_app.core.products.l1_entities
    example_4_django_ecommerce_app.ecommerce_app.core.products.l2_use_cases
forbidden_modules =
    # HTTP clients
    requests
    httpx
    # Database ORMs
    sqlalchemy
    django
    # Web frameworks
    fastapi
    flask
    # External APIs
    boto3
    botocore
    # JSON/serialization
    pydantic
