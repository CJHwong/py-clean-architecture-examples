[English Version](./principles.md)

---

# 整潔架構的核心原則

本文件旨在簡潔地總結支撐「整潔架構」(Clean Architecture) 的基本原則。這些原則指導我們設計出具備獨立性、可測試性且易於維護的系統。

## 1. 依賴原則 (The Dependency Rule)

這是整潔架構中至關重要的一條規則。它規定：**原始碼的依賴方向只能指向內部**。

- 架構圖中的同心圓代表軟體中不同的層級，從中心的「高階策略 (Entities)」到外部的「低階細節 (Frameworks & Drivers)」。
- 內層的圓，對於外層的圓一無所知。更具體地說，內層圓的程式碼，不能引用任何在外層圓中宣告的名稱（例如類別、函式、變數）。
- 這確保了核心業務邏輯與外部考量完全解耦 (decoupled)。

### 2. 獨立性 (Independence)

此架構的關鍵目標，是建立一個不受外部因素影響的獨立系統。

- **獨立於框架 (Frameworks)：** 核心業務邏輯不依賴任何特定的函式庫或框架（例如 Django, FastAPI）。框架只是一個被使用的工具，而不是我們必須遵從的結構。它屬於低階的細節。
- **獨立於使用者介面 (UI)：** UI 可以被輕易替換（例如，從 Web 應用程式換成主控台應用程式），而無需對底層的業務規則做任何修改。
- **獨立於資料庫 (Database)：** 核心邏輯不與特定的資料庫廠商綁定。您可以將 PostgreSQL 換成 MongoDB，而無需修改「實體 (Entities)」或「使用案例 (Use Cases)」。
- **獨立於任何外部事物：** 業務規則對於外部世界一無所知。

### 3. 邊界與插件 (Boundaries and Plugins)

此架構是透過在各層之間建立清晰的**邊界 (boundaries)** 來實現的。

- 這些邊界由「依賴原則」來強制執行。
- 建立這些邊界的主要機制是**依賴反轉原則 (Dependency Inversion Principle, DIP)**，即由內層定義介面（抽象），並由外層來實作。
- 這種做法將整個系統變成一個「插件式架構」。UI、資料庫、Web 框架以及其他外部服務，都像是核心業務規則的「插件」。

### 4. 可測試性 (Testability)

這種關注點分離的設計，直接帶來了高度可測試性的優點。

- **企業級業務規則 (Entities)** 可以被完全獨立地進行測試，因為它們沒有任何外部依賴。
- **應用程式業務規則 (Use Cases)** 同樣可以在不需要 UI、資料庫或 Web 伺服器的情況下進行測試。您可以使用簡��的測試替身 (test doubles)，例如模擬 (mocks) 或樁件 (stubs)，來替代外層的功能。
- 這使得測試變得快速、可靠且易於撰寫。

### 5. 尖叫的架構 (A "Screaming" Architecture)

一個專案的頂層結構，應該要能立即傳達出它的**用途和領域**，而不是它所使用的技術。

- 在專案的頂層目錄中，您不應該看到 `models`、`views`、`controllers`，而應該看到能反映系統使用案例的目錄，例如 `order_management` (訂單管理)、`customer_accounts` (客戶帳戶) 或 `inventory_tracking` (庫存追蹤)。
- 架構應該要能「尖叫」出它的業務領域，而不是它所使用的框架。
